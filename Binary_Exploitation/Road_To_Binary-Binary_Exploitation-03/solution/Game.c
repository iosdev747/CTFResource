#include <unistd.h>
#include <sys/types.h>
#include <stdio.h>
#include <stdlib.h>

#define BUFFSIZE 64
#define FLAGSIZE 64

int xlib[6][6]= {
		{102,49,93,65,91,52,},
		{77,119,104,87,53,52,},
		{99,92,78,103,80,80,},
		{100,91,49,102,52,123,},
		{127,53,81,52,82,33,},
		{75,113,88,84,71,32,}
                };

void get_flag() {
  for(int i = 0; i < 6; i++) {
    for(int j = 0; j < 6; j++) {
      printf("%c", xlib[j][i]^i^j);
    }
  }
}

void buggy_function(){
  char buf[BUFFSIZE];
  gets(buf);
  printf("from buggy function returning to address:0x%x \n", __builtin_return_address(0));
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  puts("Give me a string and lets see what happens: ");
  buggy_function();
  return 0;
}
